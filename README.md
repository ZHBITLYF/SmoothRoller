# SmoothRoller - Windows 平滑滚动工具

一个类似 SmoothRoller 的 Windows 应用程序，让 Windows 鼠标滚轮拥有像 macOS 一样的平滑滚动体验。

## 功能特性

- ✅ **全局平滑滚动**: 对所有应用程序生效的系统级平滑滚动
- ✅ **参数调节**: 可调节滚动速度、加速度、平滑度等多项参数
- ✅ **系统托盘**: 最小化到系统托盘，不占用任务栏空间
- ✅ **开机自启**: 支持开机自动启动功能
- ✅ **配置保存**: 自动保存用户设置，重启后保持配置
- ✅ **轻量级**: 占用资源少，运行稳定

## 系统要求

- Windows 10/11
- .NET 6.0 Runtime (如果使用独立版本则不需要)

## 安装使用

### 方法一：直接运行编译好的程序
1. 运行 `SmoothRoller.exe`
2. 程序会自动最小化到系统托盘
3. 右键托盘图标可以打开设置界面

### 方法二：从源码编译
1. 确保已安装 .NET 6.0 SDK
2. 在项目目录下运行：
   ```bash
   dotnet publish -c Release -r win-x64 --self-contained false -p:PublishSingleFile=true
   ```
3. 运行生成的可执行文件
   ```bash
   dist\win-x64\SmoothRoller.exe
   ```
4. 程序会自动最小化到系统托盘
5. 右键托盘图标可以打开设置界面

## 使用说明

### 基本操作
- **启动程序**: 双击运行 SmoothRoller.exe
- **打开设置**: 右键系统托盘图标 → 设置
- **开机自启**: 右键系统托盘图标 → 开机自启
- **退出程序**: 右键系统托盘图标 → 退出

### 参数说明

| 参数 | 说明 | 范围 | 默认值 |
|------|------|------|--------|
| 步长 | 单次操作鼠标窗口滑动的像素距离 | 1 - 200像素 | 90像素 |
| 动画时间 | 滚动动画效果持续的时间长度 | 100 - 2000ms | 360ms |
| 滚动加速 | 数值越高，窗口滚动也越快 | 1 - 100 | 70 |
| 最大加速倍速 | 滚动速度最高能加速到正常速度的倍数 | 1 - 20 | 7 |
| 减速/加速比 | 一次滚动中减速时间与加速时间的比值设置 | 1 - 10 | 4 |

### 高级选项
- **启用平滑滚动**: 开启/关闭平滑滚动功能
- **反转滚动方向**: 反转鼠标滚轮的滚动方向

## 技术实现

- **全局钩子**: 使用 Windows API 的低级鼠标钩子拦截滚轮事件
- **平滑算法**: 实现基于物理的滚动动画，包含速度、加速度和摩擦力
- **系统集成**: 支持系统托盘、开机自启等 Windows 系统功能
- **配置管理**: 使用 JSON 格式保存用户配置到程序同目录的 data 文件夹

## 文件结构

```
SmoothRoller/
├── Program.cs              # 程序入口点
├── SmoothRollerApp.cs      # 主应用程序类
├── MouseHook.cs            # 鼠标钩子和平滑滚动实现
├── ScrollConfig.cs         # 配置数据类
├── SettingsForm.cs         # 设置界面
├── SmoothRoller.csproj     # 项目文件
└── README.md               # 说明文档
```

## 注意事项

1. **管理员权限**: 某些应用可能需要以管理员身份运行才能生效
2. **防病毒软件**: 由于使用了全局钩子，可能被防病毒软件误报
3. **兼容性**: 在某些特殊应用中可能不生效（如某些游戏的全屏模式）
4. **性能**: 正常使用下对系统性能影响极小

## 故障排除

**Q: 程序无法启动？**
A: 检查是否安装了 .NET 6.0 Runtime，或尝试以管理员身份运行

**Q: 平滑滚动不生效？**
A: 确认设置中已启用平滑滚动，并尝试调整参数

**Q: 某些应用中不工作？**
A: 尝试以管理员身份运行程序，或在设置中调整参数

**Q: 开机自启不工作？**
A: 检查 Windows 启动项设置，确保程序有足够权限修改注册表

## 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

## 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目！